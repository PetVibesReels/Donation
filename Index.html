<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>PetVibes Donation</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: #ffffff;
      color: #333;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 20px;
    }
    .card {
      background: #fff;
      padding: 2.5rem;
      border-radius: 20px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      max-width: 550px;
      width: 90%;
    }
    h2 { text-align: center; color: #264e36; margin-top: 0; font-size: 2rem; }
    h1 { text-align: center; color: #264e36; font-size: 1.5rem; margin: 0 0 2rem; line-height: 1.4; }
    .payment-section {
      margin-top: 2rem;
      padding: 20px;
      border: 1px solid #eee;
      border-radius: 12px;
    }
    .section-title {
      font-size: 1.3rem;
      font-weight: 600;
      margin-bottom: 1rem;
      color: #555;
      text-align: left;
    }
    label {
      display: block;
      margin: 0.5rem 0 0.3rem;
      font-weight: 600;
    }
    input[type="number"] {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 1rem;
      box-sizing: border-box;
      text-align: center;
      max-width: 250px;
      margin: 0 auto 15px;
      display: block;
    }
    #paypal-buttons {
      width: 100%;
      max-width: 300px;
      margin: 15px auto 0;
    }
    .btn-crypto {
      background-color: #FF9800;
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 10px;
      font-size: 1rem;
      cursor: pointer;
      width: 100%;
      transition: 0.3s ease;
    }
    .btn-crypto:hover {
      background-color: #F57C00;
    }
    .modal {
      display: none;
      position: fixed;
      z-index: 100;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0,0,0,0.6);
    }
    .modal-content {
      background-color: #fefefe;
      margin: 10% auto;
      padding: 30px;
      border-radius: 12px;
      width: 90%;
      max-width: 450px;
      position: relative;
      text-align: left;
    }
    .close-btn {
      color: #aaa;
      float: right;
      font-size: 30px;
      font-weight: bold;
      position: absolute;
      top: 10px;
      right: 20px;
      cursor: pointer;
    }
    .currency-select {
      padding: 10px;
      width: 100%;
      margin-bottom: 15px;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 1rem;
    }
    .crypto-details {
      margin-top: 15px;
      text-align: center;
    }
    .crypto-details p {
      background-color: #f0f0f0;
      padding: 10px;
      border-radius: 6px;
      word-break: break-all;
      font-size: 0.95rem;
      margin-top: 5px;
      text-align: left;
    }
    .qr-code-img {
      display: block;
      margin: 15px auto 5px;
      width: 180px;
      height: 180px;
      border: 1px solid #ddd;
      border-radius: 6px;
      padding: 5px;
    }
    .footer {
      text-align: center;
      font-size: 0.9rem;
      color: #666;
      margin-top: 1.5rem;
    }
  </style>

  <script src="https://www.paypal.com/sdk/js?client-id=BAAqFBJEFBE1uOfU5Ur5lGCvvDtDvh8rHzfEw44mFeSi-yBPrgg9EHylOB8VV1M0roL7gIgVdx1_ePXEsE&currency=USD"></script>
</head>
<body>
  <div class="card">
    <h2>üêæ PetVibes</h2>
    <h1>Thanks to you, we provide food for 1500 pets and offer them shelter üíö</h1>

    <div class="payment-section">
      <div class="section-title">Support us with PayPal or Card:</div>
      <label for="donation-amount">Donation amount (USD)</label>
      <input type="number" id="donation-amount" step="0.01" min="1" value="33.00">
      <div id="paypal-buttons"></div>
    </div>

    <div class="payment-section">
      <div class="section-title">Pay with Crypto Currency:</div>
      <button id="openCryptoModal" class="btn-crypto">Pay with Crypto</button>
    </div>

    <div class="footer">
      üêæ Every dollar helps us rescue, feed, and care for more animals. Thank you for your kindness!
    </div>
  </div>

  <div id="cryptoModal" class="modal">
    <div class="modal-content">
      <span class="close-btn">&times;</span>
      <h3>Crypto Donation Gateway</h3>
      <p>Please select a currency to view the donation address.</p>

      <select id="currencySelect" class="currency-select">
        <option value="none" selected disabled>Select a Crypto Currency</option>
        <option value="usdt">USDT (BEP20)</option>
        <option value="usdc">USDC (BEP20)</option>
      </select>

      <div id="cryptoDetails" class="crypto-details"></div>
    </div>
  </div>

<script>
// Wallet and Crypto details setup
const WALLET = "0x6eacffa827a7667b6a8bfc9bbe9491a6fc1d86c0";
const CRYPTO = {
  usdt: {
    address: WALLET,
    // Updated USDT QR code link
    qr: "https://i.imgur.com/Urfs5FW.jpeg", 
    network: "BEP20"
  },
  usdc: {
    address: WALLET,
    // Updated USDC QR code link
    qr: "https://i.imgur.com/XXqyJ6Z.jpeg", 
    network: "BEP20"
  }
};

// **1. Crypto Modal Logic**
document.getElementById("openCryptoModal").onclick = () => {
  document.getElementById("cryptoModal").style.display = "block";
  document.getElementById("cryptoDetails").innerHTML = "";
  document.getElementById("currencySelect").value = "none";
};

document.querySelector(".close-btn").onclick = () => {
  document.getElementById("cryptoModal").style.display = "none";
};

window.onclick = (e) => {
  if (e.target === document.getElementById("cryptoModal")) {
    document.getElementById("cryptoModal").style.display = "none";
  }
};

// **2. Crypto Details Display Logic**
document.getElementById("currencySelect").onchange = function() {
  const c = CRYPTO[this.value];
  if (!c) return;

  document.getElementById("cryptoDetails").innerHTML = `
    <h4 style="text-align:center;">${this.value.toUpperCase()} (${c.network})</h4>
    <strong>Wallet Address:</strong><p>${c.address}</p>
    <strong>Scan QR Code:</strong>
    <img src="${c.qr}" class="qr-code-img">
    <p style="text-align:center; font-size:0.9rem; color:#555;">
      (Please use ${c.network} network only)
    </p>
  `;
};

// **3. PayPal Buttons Rendering Logic**
const renderPayPalButtons = () => {
  // Clear any existing buttons before rendering
  const paypalButtonsContainer = document.getElementById('paypal-buttons');
  if (paypalButtonsContainer) {
    paypalButtonsContainer.innerHTML = '';
  }

  // Get the dynamic donation amount from the input field
  const amountInput = document.getElementById('donation-amount');
  const amount = amountInput ? amountInput.value : '33.00'; 

  // Check if PayPal SDK is loaded
  if (typeof paypal === 'undefined') {
    console.error('PayPal SDK not loaded.');
    return;
  }

  paypal.Buttons({
    // Set up the transaction
    createOrder: (data, actions) => {
      return actions.order.create({
        purchase_units: [{
          amount: {
            value: amount
          }
        }]
      });
    },
    // Capture the funds when the transaction is approved
    onApprove: (data, actions) => {
      return actions.order.capture().then(details => {
        alert('Transaction completed by ' + details.payer.name.given_name + '. Thank you for your donation!');
      });
    },
    onCancel: (data) => {
        console.log('Order cancelled: ' + data.orderID);
    },
    onError: (err) => {
        console.error('An error occurred during payment: ' + err);
    }
  }).render('#paypal-buttons');
};

// Re-render buttons when the donation amount changes
document.getElementById('donation-amount').onchange = renderPayPalButtons;

// Initial attempt to render the buttons after a short delay to ensure SDK is loaded
setTimeout(() => {
    if (typeof paypal !== 'undefined') {
        renderPayPalButtons();
    } else {
        console.error('Could not initialize PayPal buttons: SDK not found after delay.');
    }
}, 500); 

</script>

</body>
</html>
